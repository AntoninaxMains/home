<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation Test</title>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <h1>Translation Loading Test</h1>
    <div id="status">Loading...</div>
    <button onclick="testTranslations()">Test Translations</button>
    <div id="output"></div>

    <script>
        // 偵測用戶語言 / Detect user language
        const savedLang = localStorage.getItem('language');
        const browserLang = navigator.language || navigator.userLanguage;
        const langMap = {
            'en': 'en',
            'en-US': 'en',
            'en-GB': 'en',
            'zh-CN': 'zh-CN',
            'zh-Hans': 'zh-CN',
            'zh-SG': 'zh-CN',
            'zh-TW': 'zh-TW',
            'zh-Hant': 'zh-TW',
            'zh-HK': 'zh-TW',
            'zh-MO': 'zh-TW',
            'ja': 'ja',
            'ja-JP': 'ja'
        };
        
        const detectedLang = savedLang || langMap[browserLang] || 'zh-TW';
        const supportedLanguages = ['en', 'zh-CN', 'zh-TW', 'ja'];
        const currentLanguage = supportedLanguages.includes(detectedLang) ? detectedLang : 'en';
        
        console.log('Detected language:', detectedLang);
        console.log('Current language:', currentLanguage);
        
        // 動態載入對應語言文件 / Dynamically load corresponding language file
        const script = document.createElement('script');
        script.src = `i18n/${currentLanguage}.js`;
        script.onload = function() {
            console.log('Language file loaded');
            
            // 設置全局 translations 對象 / Set global translations object
            const translations = {};
            
            // 根據載入的語言設置對應的翻譯
            if (currentLanguage === 'en' && typeof en !== 'undefined') {
                translations['en'] = en;
                console.log('English loaded:', Object.keys(en).length, 'keys');
            } else if (currentLanguage === 'zh-CN' && typeof zhCN !== 'undefined') {
                translations['zh-CN'] = zhCN;
                console.log('Simplified Chinese loaded:', Object.keys(zhCN).length, 'keys');
            } else if (currentLanguage === 'zh-TW' && typeof zhTW !== 'undefined') {
                translations['zh-TW'] = zhTW;
                console.log('Traditional Chinese loaded:', Object.keys(zhTW).length, 'keys');
            } else if (currentLanguage === 'ja' && typeof ja !== 'undefined') {
                translations['ja'] = ja;
                console.log('Japanese loaded:', Object.keys(ja).length, 'keys');
            }
            
            window.translations = translations;
            window.currentLanguage = currentLanguage;
            
            document.getElementById('status').textContent = 'Loaded: ' + currentLanguage;
            document.getElementById('output').innerHTML = '<pre>' + JSON.stringify(translations, null, 2) + '</pre>';
        };
        script.onerror = function() {
            console.error('Failed to load language file:', currentLanguage);
            document.getElementById('status').textContent = 'Error loading: ' + currentLanguage;
        };
        document.head.appendChild(script);

        function testTranslations() {
            console.log('Testing translations...');
            console.log('window.translations:', window.translations);
            console.log('window.currentLanguage:', window.currentLanguage);
        }
    </script>
</body>
</html>
