# 天氣功能改進說明

## 🔧 修復的問題

### 1. 手機端天氣搜索被遮擋 ✅
**問題：** 在手機端，天氣位置搜索的下拉建議框被下方的卡片遮擋，無法點擊。

**解決方案：**
- 在手機端（螢幕寬度 < 1024px）將建議框改為 `position: fixed`
- 設置更高的 `z-index: 10000` 確保在所有元素之上
- 調整建議框位置為全螢幕寬度（左右各留 16px 邊距）
- 限制最大高度為 60vh，避免超出螢幕

### 2. 天氣搜索下拉框不顯示 ✅
**問題：** 輸入地點後，建議列表沒有顯示出來。

**解決方案：**
- 添加 `.show` 類來控制顯示/隱藏
- 修復 CSS 中的 `display: none` 和 `.show` 類衝突
- 確保建議框在桌面端使用相對定位 (`position: absolute`)
- 在手機端使用固定定位避免被遮擋

### 3. 很多地方找不到天氣數據 ✅
**問題：** Open-Meteo 的地理編碼 API 覆蓋範圍有限，很多城市和地區搜索不到。

**解決方案：**
- 實現雙重 API 備用機制：
  1. **主要 API**: Open-Meteo Geocoding API（快速，覆蓋主要城市）
  2. **備用 API**: Nominatim (OpenStreetMap) API（覆蓋範圍更廣，包含更多小城市和地標）
  
- 搜索流程：
  1. 首先嘗試 Open-Meteo API
  2. 如果沒有結果或失敗，自動切換到 Nominatim API
  3. 統一格式化兩個 API 的返回結果

## 📊 API 對比

| 特性 | Open-Meteo | Nominatim (OSM) |
|------|-----------|-----------------|
| 速度 | ⚡ 快 | 🐢 較慢 |
| 覆蓋範圍 | 🌍 主要城市 | 🗺️ 全球詳細 |
| 免費使用 | ✅ 是 | ✅ 是 |
| 需要 API Key | ❌ 否 | ❌ 否 |
| 限制 | 較少結果 | 需要 User-Agent |

## 🎯 改進效果

### 桌面端
- ✅ 搜索建議框正確顯示在輸入框下方
- ✅ 可以正常點擊選擇位置
- ✅ 更廣泛的地點搜索結果

### 手機端
- ✅ 建議框不再被其他元素遮擋
- ✅ 全螢幕寬度顯示，更容易點擊
- ✅ 滾動查看更多結果
- ✅ 自動限制高度避免超出螢幕

## 🌐 支持的地點範圍

現在可以搜索到：
- ✅ 主要城市（如：台北、東京、紐約）
- ✅ 中小城市（如：高雄、墾丁、花蓮）
- ✅ 鄉鎮地區（如：台灣各鄉鎮市）
- ✅ 地標和特殊區域
- ✅ 全球各地的行政區劃

## 🔄 使用方式

1. 打開設定 → 天氣
2. 在「地點」輸入框中輸入城市名稱（至少 2 個字元）
3. 等待 300ms 後自動搜索
4. 從下拉列表中選擇正確的地點
5. 系統會自動獲取天氣數據

## 🐛 已知限制

- Nominatim API 有請求頻率限制（每秒 1 次請求）
- 搜索結果會被緩存以減少 API 請求
- 某些非常偏遠的地區可能仍然找不到

## 💡 未來可能的改進

- [ ] 添加 IP 定位自動檢測當前位置
- [ ] 支持經緯度直接輸入
- [ ] 添加最近搜索歷史
- [ ] 支持更多天氣數據提供商

---

**修改時間**: 2025年10月19日  
**影響文件**: `app.css`, `script.js`
